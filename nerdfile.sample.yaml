configuration:
  slack:
    webhook: ***REMOVED***
    channel: "@cdmbr"
    icon: ":vbyte:"
    bot: nerdployer-test
flow:
  steps:
  - name: aws_regions
    type: awscli
    parameters:
      service: ec2
      command: describe-regions
  - name: invalid_command
    type: awscli
    ignore_errors: true
    parameters:
      service: ec2
      command: not-existent-cmd
  - name: git_version
    type: git
  - name: my_beautiful_slack_message
    type: template
    parameters:
      content: |-
        *current repository version is:* `[[git-revision]]`
        *regions found:* `[[{regions}]]`
      mappings:
        git-revision: {{git_version}}
        regions: {{{aws_regions.Regions}}}
  - name: notify_version_and_region
    type: slack
    parameters:
      message: {{{my_beautiful_slack_message}}}
  recovery:
  - name: notify_error
    type: slack
    parameters:
      message: |-
        *an error occurred running step:* `{{ error.step }}`
        *error:* `{{{ error.exception }}}`